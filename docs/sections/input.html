<h1 id="input">Input</h1>

<p>SpinVibe requires several inputs from other codes and parameters to perform spin-phonon coupling simulations. 
    All input files are required to be formated in HDF5 format for universal compatibility.</p>


<h2>Required Input Files</h2>

<h3>1. Molecular spin hamiltonian calculation Output</h3>
<div class="input-file">
    <div class="file-header">
        <span class="filename">spin.h5</span>
        <span class="file-format">HDF5 Format</span>
    </div>
    <p>Contains unperturbed g-tensor and zero-field splitting (D) tensor from quantum chemistry calculations.</p>
    
    <h4>Required Datasets:</h4>
    <ul>
        <li><code>/g_tensor</code> - 3×3 g-tensor matrix</li>
        <li><code>/d_tensor</code> - 3×3 zero-field splitting tensor</li>
    </ul>
    
    <div class="code-example">
        <div class="code-header">Example Structure</div>
        <pre><code class="python">import h5py

with h5py.File('Cr_otolyl_4.h5', 'r') as f:
    g_tensor = f['g_tensor'][:]        # shape: (3, 3)
    d_tensor = f['d_tensor'][:]        # shape: (3, 3)

    </div>
</div>

<h3>2. Phonon Data</h3>
<div class="input-file">
    <div class="file-header">
        <span class="filename">phonon.h5</span>
        <span class="file-format">HDF5 Format</span>
    </div>
    <p>Contains phonon frequencies and eigenvectors from solid-state calculations.</p>
    
    <h4>Required Datasets:</h4>
    <ul>
        <li><code>/frequencies</code> - Phonon frequencies in cm⁻¹</li>
        <li><code>/eigenvectors</code> - Phonon eigenvectors</li>
        <li><code>/q_points</code> - Q-points in reciprocal space</li>
    </ul>
    
    <div class="code-example">
        <div class="code-header">Example Structure</div>
        <pre><code class="python">with h5py.File('phonon.h5', 'r') as f:
            q_points = f['q_points'][1:, :]
            frequencies_cm = f['frequencies_cm'][1:, :]
            eigenvectors = f['eigenvectors'][1:, :]
    </div>
</div>

<h3>3. Tensor Derivatives</h3>

<div class="input-file">
    <div class="file-header">
        <span class="filename">d1.h5</span>
        <span class="file-format">HDF5 Format</span>
    </div>
    <p>First derivatives of g and D tensors with respect to atomic displacements.</p>
    
    <div class="code-example">
        <div class="code-header">Example Structure</div>
        <pre><code class="python">with h5py.File(self.d1_file, 'r') as f:
            D_d1 = f['d_tensor'][:]
            G_d1 = f['g_matrix'][:]
    </div>
</div>

<div class="input-file">
    <div class="file-header">
        <span class="filename">d2.h5, g2.h5</span>
        <span class="file-format">HDF5 Format</span>
    </div>
    <p>Second derivatives of D and g tensors</p>
    
    <div class="code-example">
        <div class="code-header">Example Structure</div>
        <pre><code class="python">with h5py.File(self.d2_file, 'r') as f:
            D_d2 = f['d_tensor'][:]

        with h5py.File(self.g2_file, 'r') as f:
            G_d2 = f['g_tensor'][:]
    </div>
</div>

<h3>4. Structural Information</h3>

<div class="input-file">
    <div class="file-header">
        <span class="filename">Sn_otolyl_4_atoms.h5</span>
        <span class="file-format">HDF5 Format</span>
    </div>
    <p>Contains atomic positions and crystal structure information.</p>
    
    <h4>Required Datasets:</h4>
    <ul>
        <li><code>/atomic_positions</code> - Atomic coordinates in Å</li>
        <li><code>/reciprocal_vectors</code> - Reciprocal lattice vectors</li>
        <li><code>/lattice_vectors</code> - Real-space lattice vectors</li>
        <li><code>/atomic_numbers</code> - Element atomic numbers</li>
    </ul>
</div>

<div class="input-file">
    <div class="file-header">
        <span class="filename">molecule_indices.h5</span>
        <span class="file-format">HDF5 Format</span>
    </div>
    <p>Indices of atoms belonging to the molecular qubit within the crystal.</p>
    
    <h4>Required Datasets:</h4>
    <ul>
        <li><code>/molecule_indices</code> - Atom indices in the molecule</li>
        <li><code>/molecule_center</code> - Center of mass coordinates</li>
    </ul>
</div>

<div class="input-file">
    <div class="file-header">
        <span class="filename">mol_mass.h5</span>
        <span class="file-format">HDF5 Format</span>
    </div>
    <p>Atomic masses for phonon calculations.</p>
    
    <h4>Required Datasets:</h4>
    <ul>
        <li><code>/atomic_masses</code> - Masses of atoms in atomic units</li>
        <li><code>/element_symbols</code> - Chemical element symbols</li>
    </ul>
</div>

<hr>

<h2>Simulation Parameters</h2>

<div class="parameter-section">
    <h3>Physical Parameters</h3>
    
    <div class="parameter">
        <h4>Magnetic Field (B)</h4>
        <p><strong>Type:</strong> numpy array<br>
           <strong>Format:</strong> <code>[Bx, By, Bz]</code> in Tesla<br>
           <strong>Example:</strong> <code>np.array([0.0, 0.0, 0.410])</code><br>
           <strong>Description:</strong> External magnetic field vector applied to the system.</p>
    </div>
    
    <div class="parameter">
        <h4>Spin Quantum Number (S)</h4>
        <p><strong>Type:</strong> integer or half-integer<br>
           <strong>Example:</strong> <code>1</code> (for S=1 system)<br>
           <strong>Description:</strong> Total spin quantum number of the molecular qubit.</p>
    </div>
    
    <div class="parameter">
        <h4>Temperature (T)</h4>
        <p><strong>Type:</strong> float<br>
           <strong>Unit:</strong> Kelvin<br>
           <strong>Example:</strong> <code>300.0</code><br>
           <strong>Description:</strong> Simulation temperature.</p>
    </div>
    
    <div class="parameter">
        <h4>Broadening Parameter (Δα_q)</h4>
        <p><strong>Type:</strong> float<br>
           <strong>Unit:</strong> cm⁻¹<br>
           <strong>Example:</strong> <code>0.1</code><br>
           <strong>Description:</strong> Phonon linewidth broadening parameter.</p>
    </div>
</div>

<div class="parameter-section">
    <h3>Time Parameters</h3>
    
    <div class="parameter">
        <h4>Total Time (tf)</h4>
        <p><strong>Type:</strong> float<br>
           <strong>Unit:</strong> seconds<br>
           <strong>Example:</strong> <code>1E-3</code> (1 millisecond)<br>
           <strong>Description:</strong> Total simulation time.</p>
    </div>
    
    <div class="parameter">
        <h4>Time Step (dt)</h4>
        <p><strong>Type:</strong> float<br>
           <strong>Unit:</strong> seconds<br>
           <strong>Example:</strong> <code>1E-6</code> (1 microsecond)<br>
           <strong>Description:</strong> Time step for numerical integration.</p>
    </div>
</div>

<div class="parameter-section">
    <h3>Initial State Parameters</h3>
    
    <div class="parameter">
        <h4>Initial State Type</h4>
        <p><strong>Type:</strong> string<br>
           <strong>Options:</strong> <code>'pure'</code>, <code>'polarized'</code>, <code>'boltzmann'</code>, <code>'photon'</code><br>
           <strong>Default:</strong> <code>'pure'</code><br>
           <strong>Description:</strong> Method for initializing the spin density matrix.</p>
    </div>
    
    <div class="parameter">
        <h4>Polarization Vector</h4>
        <p><strong>Type:</strong> numpy array<br>
           <strong>Format:</strong> <code>[px, py, pz]</code><br>
           <strong>Example:</strong> <code>np.array([0, 0, 1])</code><br>
           <strong>Description:</strong> Initial spin polarization direction.</p>
    </div>
</div>

<div class="parameter-section">
    <h3>Crystal Structure Parameters</h3>
    
    <div class="parameter">
        <h4>Rotation Matrix</h4>
        <p><strong>Type:</strong> 3×3 numpy array<br>
           <strong>Example:</strong> <code>np.array([[0,0,1], [1,0,0], [0,1,0]])</code><br>
           <strong>Description:</strong> Matrix to align molecular frame with crystal frame.</p>
    </div>
    
    <div class="parameter">
        <h4>Number of Unit Cells (Ncells)</h4>
        <p><strong>Type:</strong> integer<br>
           <strong>Example:</strong> <code>1</code><br>
           <strong>Description:</strong> Number of unit cells to include in supercell calculation.</p>
    </div>
</div>

<hr>

<h2>Input File Generation</h2>

<p>Here's an example Python script to generate the required HDF5 input files:</p>

<div class="code-example">
    <div class="code-header">generate_inputs.py</div>
    <pre><code class="python">import h5py
import numpy as np

# Generate ORCA output file
with h5py.File('Cr_otolyl_4.h5', 'w') as f:
    # Example g-tensor (isotropic)
    g_tensor = np.array([[2.0023, 0.0000, 0.0000],
                         [0.0000, 2.0023, 0.0000],
                         [0.0000, 0.0000, 2.0023]])
    f.create_dataset('g_tensor', data=g_tensor)
    
    # Example D-tensor
    d_tensor = np.array([[0.500, 0.000, 0.000],
                         [0.000, 0.500, 0.000],
                         [0.000, 0.000, -1.000]])
    f.create_dataset('d_tensor', data=d_tensor)
    
    # Electronic energy
    f.create_dataset('energy', data=-1250.45)

# Generate phonon file
with h5py.File('Sn_otolyl_4_223.h5', 'w') as f:
    n_phonons = 100
    n_atoms = 20
    
    frequencies = np.linspace(10, 500, n_phonons)  # cm⁻¹
    eigenvectors = np.random.random((n_atoms, 3, n_phonons))
    q_points = np.random.random((50, 3))
    
    f.create_dataset('frequencies', data=frequencies)
    f.create_dataset('eigenvectors', data=eigenvectors)
    f.create_dataset('q_points', data=q_points)

print("Input files generated successfully!")</code></pre>
</div>

<div class="note">
    <div class="note-title">File Validation</div>
    <p>Use the <code>read_files.py</code> module to validate your input files before running simulations.</p>
</div>

<style>
.input-file {
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 5px;
    padding: 20px;
    margin: 15px 0;
}

.file-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.filename {
    font-family: 'Courier New', monospace;
    font-weight: bold;
    color: #2c3e50;
}

.file-format {
    background: #2980b9;
    color: white;
    padding: 2px 8px;
    border-radius: 3px;
    font-size: 12px;
}

.parameter-section {
    margin: 25px 0;
}

.parameter-section h3 {
    color: #2c3e50;
    border-bottom: 2px solid #e1e4e5;
    padding-bottom: 8px;
    margin-bottom: 15px;
}

.parameter {
    background: white;
    border: 1px solid #e9ecef;
    border-radius: 5px;
    padding: 15px;
    margin: 10px 0;
}

.parameter h4 {
    margin: 0 0 10px 0;
    color: #2980b9;
    font-size: 1.1em;
}

.parameter p {
    margin: 5px 0;
}

.code-example {
    background: #f8f9fa;
    border: 1px solid #e1e4e5;
    border-radius: 5px;
    margin: 15px 0;
}

.code-header {
    background: #e9ecef;
    padding: 10px 15px;
    border-bottom: 1px solid #dee2e6;
    font-family: 'Courier New', monospace;
    font-weight: bold;
}

@media (max-width: 768px) {
    .file-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
    }
    
    .parameter {
        padding: 10px;
    }
}
</style>
